1. Installation:

On Shackleton, download the Prospectus Tools git repository:
git clone https://github.com/jrising/prospectus-tools/

2. Collect results for each type of file for a given aggregated region:

From within the gcp/extract directory (in that tools repo), run the following
```
python byrcpssp.py configs/timeseries.yml BASE-FILENAME REGION
```

- `BASE-FILENAME` is the filename part of files in each of the individual result directories.  For example, if you want to extract data from all files called "global_interaction_best.nc4", use `global_interaction_best`.
- `REGION` is any region specified in those files.  In an unaggregated file, this must be the name of an impact region.  In an aggregated file, it may be `global`, an ISO3 country, or a FUND region specified in the form FUND-XXX.  To get a full list of the region names available in a given file, type `ncdump -v regions FILEPATH`.

So, for example, to generate all of the timeseries needed for the global aggregation, I do:

```
python byrcpssp.py configs/timeseries.yml interpolated_mortality_all_ages-histclim-aggregated global
python byrcpssp.py configs/timeseries.yml interpolated_mortality_all_ages-aggregated global
python byrcpssp.py configs/timeseries.yml interpolated_mortality_dumb_all_ages-aggregated global
python byrcpssp.py configs/timeseries.yml interpolated_mortality_comatose_all_ages-aggregated global
python byrcpssp.py configs/timeseries.yml interpolated_mortality_all_ages-costs-aggregated global costs_lb
python byrcpssp.py configs/timeseries.yml interpolated_mortality_all_ages-costs-aggregated global costs_ub
```

3. Generate the various median across kinds of results

The quantilebyrcpssp.py script generates quantiles of the values or difference of values generated `by byrcpssp.py`.  The syntax is:

```
python quantilebyrcpssp.py COLLECTED-FILES-DIRECTORY FILE-SUFFIX <HISTORICAL-SUFFIX>
```

Where `COLLECTED-FILES-DIRECTORY` is the full path to one of the directories generated by the byrcpssp.py script.  `FILE-SUFFIX` is the part of the file names in that directory after the GCM and SSP model: for example, `global_interaction_best-rebased` for a set of files including the file `CSIRO-Mk3-6-0-OECD_Env-Growth-global_interaction_best-rebased.csv`.  `HISTORICAL-SUFFIX` is like `FILE-SUFFIX` and optionally specifies a baseline (typically called the same thing as `FILE-SUFFIX` but dropping any farmer suffix and adding the suffix `-histclim`).  For example:

 - The full adaptation result (subtracting histclim) might use `IMPACT-aggregated IMPACT-histclim-aggregated`.
 - Dumb or comatose farmers results might use `IMPACT-dumb-aggregated IMPACT-histclim-aggregated`.
 - To get lower and upper bounds on the costs, you could use `IMPACT-aggregated-costs_lb` (with no `HISTORICAL-SUFFIX`).

So, to generate the global costs timeseries data, I do:

```
python quantilebyrcpssp.py /shares/gcp/outputs/timeseries/rcp85-SSP3-global/ interpolated_mortality_all_ages-aggregated interpolated_mortality_all_ages-histclim-aggregated
python quantilebyrcpssp.py /shares/gcp/outputs/timeseries/rcp85-SSP3-global/ interpolated_mortality_dumb_all_ages-aggregated interpolated_mortality_all_ages-histclim-aggregated
python quantilebyrcpssp.py /shares/gcp/outputs/timeseries/rcp85-SSP3-global/ interpolated_mortality_comatose_all_ages-aggregated interpolated_mortality_all_ages-histclim-aggregated
python quantilebyrcpssp.py /shares/gcp/outputs/timeseries/rcp85-SSP3-global/ interpolated_mortality_all_ages-costs-aggregated-costs_lb
python quantilebyrcpssp.py /shares/gcp/outputs/timeseries/rcp85-SSP3-global/ interpolated_mortality_all_ages-costs-aggregated-costs_ub
```
